!function(){"use strict";class e{constructor(e,t,s){this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleImageClick=s}_handleLikeButton(){this._likeButton.classList.toggle("card__like-button_active")}_handleDeleteButton(){this._cardElement.remove(),this._cardElement=null}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeButton()})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteButton()})),this._cardImageEl.addEventListener("click",(()=>{this._handleImageClick({name:this._cardTitleEl.textContent,link:this._cardImageEl.src})}))}_getTemplate(){return this._cardElement=document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0),this._cardElement}generateCard(){return this._cardElement=this._getTemplate(),this._cardTitleEl=this._cardElement.querySelector(".card__title"),this._cardImageEl=this._cardElement.querySelector(".card__image"),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._cardTitleEl.textContent=this._name,this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name,this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._inputElements=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.remove(this._errorClass)}_checkInputVaildity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_hasInvalidInput(e){return!e.every((e=>e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?this.disableButton():this._enableButton()}_hasInvalidInput(){return!this._inputElements.every((e=>e.validity.valid))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_setEventListeners(){this._inputElements.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputVaildity(e),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}}class s{constructor(e){let{popUpSelector:t}=e;this._popUpElement=document.querySelector(t),this._popUpCloseButton=this._popUpElement.querySelector(".modal__close")}_handleEscClose=e=>{"Escape"==e.key&&this.close()};open(){this._popUpElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popUpElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popUpCloseButton.addEventListener("click",(()=>{this.close()})),this._popUpElement.addEventListener("click",(e=>{e.target.classList.contains("modal")&&this.close()}))}}class n extends s{constructor(e,t){super({popUpSelector:e}),this._popUpForm=this._popUpElement.querySelector(".modal__form"),this._handleFormSubmit=t}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}_getInputValues(){return this._inputValues={},this._inputList.forEach((e=>{this._inputValues[e.name]=e.value})),this._inputValues}setEventListeners(){this._inputList=this._popUpForm.querySelectorAll(".modal__input"),super.setEventListeners(),this._popUpForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this._popUpForm.reset()}))}close(){super.close()}}const i={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_error",errorClass:"modal__error"},r="#profile-edit-modal",a="#add-card-modal",o=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._handleResponse)}updateUserProfile(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._handleResponse)}updateAvatar(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then(this._handleResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers}).then(this._handleResponse)}createCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(this._handleResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._handleResponse())}addLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._handleResponse())}removeLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._handleResponse())}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"984e74d2-6876-48b9-aa34-b5b7c14e830a","Content-Type":"application/json"}}),l=document.querySelector(".cards__list"),c=document.querySelector("#profile-edit-button"),d=document.querySelector(r).querySelector(".modal__form"),h=(d.querySelector("#profile-title-input"),d.querySelector("#profile-description-input"),document.querySelector("#add-card-button")),u=document.querySelector(a).querySelector(".modal__form"),_=new class{constructor(e,t){let{initialArray:s,renderer:n}=e;this._initialArray=s,this._renderer=n,this._container=t}renderItems(){this._initialArray.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({initialArray:[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],renderer:e=>{const t=b(e);_.addItem(t)}},l);_.renderItems();const p=new class{constructor(e,t){this._name=document.querySelector(e),this._description=document.querySelector(t)}getUserInfo(){return this._userData={name:this._name.textContent.trim(),description:this._description.textContent.trim()},this._userData}setUserInfo(e,t){this._name.textContent=e,this._description.textContent=t}}(".profile__title",".profile__description"),m=new t(i,d),E=new t(i,u);m.enableValidation(),E.enableValidation();const v=new class extends s{constructor(e){super({popUpSelector:e}),this._imagePopUpImageEl=this._popUpElement.querySelector(".modal__image"),this._imagePopUpTitleEl=this._popUpElement.querySelector(".modal__title")}open(e){super.open(),this._imagePopUpImageEl.src=e.link,this._imagePopUpImageEl.alt=e.name,this._imagePopUpTitleEl.textContent=e.name}}("#view-image-modal"),g=new n(r,(function(e){p.setUserInfo(e.title,e.description),g.close()})),f=new n(a,(function(e){const t=b({name:e.title,link:e.url});_.addItem(t),f.close(),E.disableButton()}));function b(t){return new e(t,"#card-template",y).generateCard()}function y(e){v.open(e)}g.setEventListeners(),f.setEventListeners(),v.setEventListeners(),c.addEventListener("click",(()=>{!function(){const e=p.getUserInfo();g.setInputValues({title:e.name,description:e.description}),g.open(),m.resetValidation()}()})),h.addEventListener("click",(()=>{f.open()})),o.getInitialCards().then((e=>console.log(e)))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Y29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wVXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wVXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvQ29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3BVcFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoZGF0YSwgY2FyZFNlbGVjdG9yLCBoYW5kbGVJbWFnZUNsaWNrKSB7XG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcbiAgfVxuXG4gIC8qIEV2ZW50IEhhbmRsZXJzICovXG5cbiAgX2hhbmRsZUxpa2VCdXR0b24oKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICB9XG5cbiAgX2hhbmRsZURlbGV0ZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH1cblxuICAvKiBFdmVudCBMaXN0ZW5lcnMgKi9cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgLy8uY2FyZF9fbGlrZS1idXR0b25cbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKCk7XG4gICAgfSk7XG5cbiAgICAvLy5jYXJkX19kZWxldGUtYnV0dG9uXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b24oKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHtcbiAgICAgICAgbmFtZTogdGhpcy5fY2FyZFRpdGxlRWwudGV4dENvbnRlbnQsXG4gICAgICAgIGxpbms6IHRoaXMuX2NhcmRJbWFnZUVsLnNyYyxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLyogR2V0IHRlbXBsYXRlICovXG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkLmNsb25lTm9kZSh0cnVlKTtcblxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxuXG4gIC8qIFB1YmxpYyBtZXRob2QgdG8gZ2VuZXJhdGUgY2FyZCAqL1xuXG4gIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fY2FyZFRpdGxlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiXG4gICAgKTtcbiAgICB0aGlzLl9jYXJkVGl0bGVFbC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fY2FyZEltYWdlRWwuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5hbHQgPSB0aGlzLl9uYW1lO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcbiAgICAvL3RoaXMgaW5zaWRlIG9mIGNsYXNzIGhhbmRsZXMgY2xhc3MgaXRzZWxmXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcblxuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcblxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFpbGRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpIHtcbiAgICByZXR1cm4gIWlucHV0TGlzdC5ldmVyeSgoaW5wdXRFbGVtZW50KSA9PiBpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGlmICghdGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcbiAgICB9XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0KCkge1xuICAgIHJldHVybiAhdGhpcy5faW5wdXRFbGVtZW50cy5ldmVyeShcbiAgICAgIChpbnB1dEVsZW1lbnQpID0+IGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZFxuICAgICk7XG4gIH1cblxuICBkaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cblxuICBfZW5hYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChldnQpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhaWxkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcblxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3BVcCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wVXBTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fcG9wVXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3BVcFNlbGVjdG9yKTtcbiAgICB0aGlzLl9wb3BVcENsb3NlQnV0dG9uID0gdGhpcy5fcG9wVXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGUpID0+IHtcbiAgICBpZiAoZS5rZXkgPT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcFVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcFVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcFVwQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3BvcFVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3BVcCBmcm9tIFwiLi9Qb3BVcC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3BVcFdpdGhGb3JtIGV4dGVuZHMgUG9wVXAge1xuICBjb25zdHJ1Y3Rvcihwb3BVcFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgLy8gV2h5IHN1cGVyKHBvcFVwU2VsZWN0b3IpIGRpZCBub3Qgd29yaz8gUmVcbiAgICAvLyBQb3BVcCBhY2NlcHRzIGFuIG9iamVjdCAtLS0gaW4gaXRzIGNvbnN0cnVjdG9yXG4gICAgLy8gdnMuIFBvcFVwd2l0aEZvcm0gaW5oZXJpdHMgUG9wVXAncyBmdW5jdGlvbnMgYW5kIGluc3RhbmNlcyBieSBzdXBlcih7cG9wVXBTZWxlY3Rvcn0pIGJ1dCB0aGF0IGRvZXMgbm90IG1lYW4gcG9wVXB3aXRoRm9ybVxuICAgIC8vIG5lY2Vzc2FyaWx5IGhhdmUgdG8gYWNjZXB0IGFuIG9iamVjdCBpbiBjb25zdHJ1Y3RvciAtPiBiZWNhdXNlIHN1cGVyKHtwb3BVcFNlbGVjdG9yfSkgaXMgaGFuZGxpbmcgaXRcbiAgICBzdXBlcih7IHBvcFVwU2VsZWN0b3IgfSk7XG5cbiAgICB0aGlzLl9wb3BVcEZvcm0gPSB0aGlzLl9wb3BVcEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgfVxuXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIC8vIEhlcmUgeW91IGluc2VydCB0aGUgYHZhbHVlYCBieSB0aGUgYG5hbWVgIG9mIHRoZSBpbnB1dFxuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xuICAgIH0pO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIC8vQWxsIGVsZW1lbnRzIGZvdW5kIGV2ZXJ5IHRpbWUgeW91IGNhbGwgYSBtZXRob2Qgc2hvdWxkIGJlIGRlZmluZWQgYXMgY2xhc3MgZmllbGRzIGluIHRoZSBjb25zdHJ1Y3RvciwgaW4gb3JkZXJcbiAgICAvLyBub3QgdG8gd2FzdGUgcmVzb3VyY2VzIG9uIHNlYXJjaGluZyB0aGVtIGFnYWluIGFuZCBhZ2FpblxuICAgIC8vYnV0IGRvbid0IHdlIGdldCBkaWZmZXJlbnQgdmFsdWUgd2hlbmV2ZXIgdGhlcmUncyBuZXcgdXNlcmlucHV0P1xuXG4gICAgdGhpcy5faW5wdXRWYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIHRoaXMuX2lucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcy5faW5wdXRWYWx1ZXM7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9wb3BVcEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3BVcEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgIC8vc2hvdWxkIGNsZWFyIHRoZSBpbnB1dHMgb25seSBhZnRlciBzdWJtaXR0aW5nIGEgY2FyZCBpbiBjYXNlIGEgdXNlciBhY2NpZGVudGFsbHkgY2xvc2UgdGhlIGZvcm1cbiAgICAgIHRoaXMuX3BvcFVwRm9ybS5yZXNldCgpO1xuICAgIH0pO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuXG4gIHtcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxuICB9LFxuXG4gIHtcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICB9LFxuXG4gIHtcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcbiAgfSxcblxuICB7XG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcbiAgfSxcblxuICB7XG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxuICB9LFxuXTtcblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25Db25maWcgPSB7XG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvclwiLFxufTtcblxuZXhwb3J0IGNvbnN0IGNhcmRTZWxlY3RvciA9IFwiI2NhcmQtdGVtcGxhdGVcIjtcbmV4cG9ydCBjb25zdCBpbWFnZVBvcFVwU2VsZWN0b3IgPSBcIiN2aWV3LWltYWdlLW1vZGFsXCI7XG5leHBvcnQgY29uc3QgcHJvZmlsZVBvcFVwU2VsZWN0b3IgPSBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIjtcbmV4cG9ydCBjb25zdCBjYXJkUG9wVXBTZWxlY3RvciA9IFwiI2FkZC1jYXJkLW1vZGFsXCI7XG4iLCJpbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgUG9wVXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wVXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3BVcFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcFVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IHtcbiAgaW5pdGlhbENhcmRzLFxuICB2YWxpZGF0aW9uQ29uZmlnLFxuICBjYXJkU2VsZWN0b3IsXG4gIGltYWdlUG9wVXBTZWxlY3RvcixcbiAgcHJvZmlsZVBvcFVwU2VsZWN0b3IsXG4gIGNhcmRQb3BVcFNlbGVjdG9yLFxufSBmcm9tIFwiLi4vdXRpbHMvQ29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuXG4vKiogQVBJICoqL1xuY29uc3QgY29uZmlnID0ge1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjk4NGU3NGQyLTY4NzYtNDhiOS1hYTM0LWI1YjdjMTRlODMwYVwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufTtcblxuY29uc3QgYXBpID0gbmV3IEFwaShjb25maWcpO1xuXG4vKiogRUxFTUVOVFMgKiovXG5jb25zdCBjYXJkTGlzdEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcblxuLyogRUxFTUVOVCB8IFBST0ZJTEUgRURJVCAqL1xuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XG5jb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlUG9wVXBTZWxlY3Rvcik7XG5jb25zdCBwcm9maWxlRWRpdEZvcm0gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5cbmNvbnN0IHByb2ZpbGVUaXRsZUlucHV0ID0gcHJvZmlsZUVkaXRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gcHJvZmlsZUVkaXRGb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcblxuLyogRUxFTUVOVCB8IEFERCBDQVJEICovXG5jb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1idXR0b25cIik7XG5jb25zdCBhZGRDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNhcmRQb3BVcFNlbGVjdG9yKTtcbmNvbnN0IGFkZENhcmRGb3JtID0gYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5cbi8vIGNvbnN0IGNhcmRUaXRsZUlucHV0ID0gYWRkQ2FyZEZvcm0ucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRpdGxlLWlucHV0XCIpO1xuLy8gY29uc3QgY2FyZFVybElucHV0ID0gYWRkQ2FyZEZvcm0ucXVlcnlTZWxlY3RvcihcIiNjYXJkLXVybC1pbnB1dFwiKTtcblxuLyoqIFNFQ1RJT04gQ0xBU1MgKiovXG5cbmNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gIHtcbiAgICBpbml0aWFsQXJyYXk6IGluaXRpYWxDYXJkcyxcbiAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWwgPSBjcmVhdGVDYXJkKGNhcmREYXRhKTtcbiAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsKTtcbiAgICB9LFxuICB9LFxuICBjYXJkTGlzdEVsXG4pO1xuXG5jYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuXG4vKiogVVNFUiBDTEFTUyAqKi9cblxuY29uc3QgdXNlciA9IG5ldyBVc2VySW5mbyhcIi5wcm9maWxlX190aXRsZVwiLCBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcblxuLyoqIFZBTElEQVRPUiBDTEFTUyAqKi9cblxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uQ29uZmlnLCBwcm9maWxlRWRpdEZvcm0pO1xuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25Db25maWcsIGFkZENhcmRGb3JtKTtcblxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbi8qKiBQT1BVUCBDTEFTUyAqKi9cblxuY29uc3Qgdmlld0ltYWdlUG9wVXAgPSBuZXcgUG9wVXBXaXRoSW1hZ2UoaW1hZ2VQb3BVcFNlbGVjdG9yKTtcbmNvbnN0IHByb2ZpbGVFZGl0UG9wVXAgPSBuZXcgUG9wVXBXaXRoRm9ybShcbiAgcHJvZmlsZVBvcFVwU2VsZWN0b3IsXG4gIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0XG4pO1xuY29uc3QgYWRkQ2FyZFBvcFVwID0gbmV3IFBvcFVwV2l0aEZvcm0oY2FyZFBvcFVwU2VsZWN0b3IsIGhhbmRsZUFkZENhcmRTdWJtaXQpO1xuXG4vLyAvKiogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKiovXG4vLyBjb25zdCBjYXJkVGVtcGxhdGUgPVxuLy8gICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZDtcblxuLyoqIEZVTkNUSU9OUyAqKi9cblxuLyogQ0FSRCAqL1xuLy8gUmUgLSB3aHkgd2Uga2VlcCBjcmVhdGVDYXJkIGluIGluZGV4LmpzIGFnYWluPyBXaHkgbm90IGluIENhcmQuanM/XG5mdW5jdGlvbiBjcmVhdGVDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChjYXJkRGF0YSwgY2FyZFNlbGVjdG9yLCBoYW5kbGVJbWFnZUNsaWNrKTtcbiAgcmV0dXJuIGNhcmQuZ2VuZXJhdGVDYXJkKCk7XG59XG5cbi8qIEVWRU5UIEhBTkRMRVJTICovXG5cbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0KGRhdGEpIHtcbiAgdXNlci5zZXRVc2VySW5mbyhkYXRhLnRpdGxlLCBkYXRhLmRlc2NyaXB0aW9uKTtcbiAgcHJvZmlsZUVkaXRQb3BVcC5jbG9zZSgpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkU3VibWl0KGNhcmRJbnB1dCkge1xuICBjb25zdCBjYXJkRWwgPSBjcmVhdGVDYXJkKHsgbmFtZTogY2FyZElucHV0LnRpdGxlLCBsaW5rOiBjYXJkSW5wdXQudXJsIH0pO1xuICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbCk7XG4gIGFkZENhcmRQb3BVcC5jbG9zZSgpO1xuICBhZGRGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRCdXR0b25DbGljaygpIHtcbiAgY29uc3QgdXNlclByb2ZpbGUgPSB1c2VyLmdldFVzZXJJbmZvKCk7XG4gIHByb2ZpbGVFZGl0UG9wVXAuc2V0SW5wdXRWYWx1ZXMoe1xuICAgIHRpdGxlOiB1c2VyUHJvZmlsZS5uYW1lLFxuICAgIGRlc2NyaXB0aW9uOiB1c2VyUHJvZmlsZS5kZXNjcmlwdGlvbixcbiAgfSk7XG4gIC8vIHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gdXNlclByb2ZpbGUubmFtZTtcbiAgLy8gcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSB1c2VyUHJvZmlsZS5kZXNjcmlwdGlvbjtcbiAgcHJvZmlsZUVkaXRQb3BVcC5vcGVuKCk7XG4gIGVkaXRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKGNhcmREYXRhKSB7XG4gIHZpZXdJbWFnZVBvcFVwLm9wZW4oY2FyZERhdGEpO1xufVxuXG4vKiogRVZFTlQgTElTVEVORVJTICoqL1xuXG5wcm9maWxlRWRpdFBvcFVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5hZGRDYXJkUG9wVXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnZpZXdJbWFnZVBvcFVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGhhbmRsZVByb2ZpbGVFZGl0QnV0dG9uQ2xpY2soKTtcbn0pO1xuXG5hZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZENhcmRQb3BVcC5vcGVuKCk7XG59KTtcblxuLy8gYXBpXG4vLyAgIC5nZXRJbml0aWFsQ2FyZHMoKVxuLy8gICAudGhlbigocmVzKSA9PiB7XG4vLyAgICAgY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbi8vICAgICAgIHtcbi8vICAgICAgICAgaW5pdGlhbEFycmF5OiBpbml0aWFsQ2FyZHMsXG4vLyAgICAgICAgIHJlbmRlcmVyOiAoY2FyZERhdGEpID0+IHtcbi8vICAgICAgICAgICBjb25zdCBjYXJkRWwgPSBjcmVhdGVDYXJkKGNhcmREYXRhKTtcbi8vICAgICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbCk7XG4vLyAgICAgICAgIH0sXG4vLyAgICAgICB9LFxuLy8gICAgICAgY2FyZExpc3RFbFxuLy8gICAgICk7XG5cbi8vICAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuLy8gICB9KVxuLy8gICAuY2F0Y2goKGVycikgPT4ge1xuLy8gICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yOiAke2Vycn1gKTtcbi8vICAgfSk7XG5cbmFwaS5nZXRJbml0aWFsQ2FyZHMoKS50aGVuKChyZXMpID0+IGNvbnNvbGUubG9nKHJlcykpO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIF9oYW5kbGVSZXNwb25zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcbiAgfVxuXG4gIC8vbmFtZSwgYWJvdXQsIF9pZFxuICB1cGRhdGVVc2VyUHJvZmlsZSh1c2VyRGF0YSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHVzZXJEYXRhKSxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcbiAgfVxuXG4gIHVwZGF0ZUF2YXRhcih7IGF2YXRhciB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyOiBhdmF0YXIgfSksXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcbiAgfVxuXG4gIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGNhcmREYXRhKSxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSgpKTtcbiAgfVxuXG4gIGFkZExpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSgpKTtcbiAgfVxuXG4gIHJlbW92ZUxpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSgpKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaW5pdGlhbEFycmF5LCByZW5kZXJlciB9LCBjb250YWluZXIpIHtcbiAgICB0aGlzLl9pbml0aWFsQXJyYXkgPSBpbml0aWFsQXJyYXk7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBjb250YWluZXI7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICAvL3VzZSB0aGlzLl9yZW5kZXJlclxuICAgIC8vIHRvIGNyZWF0ZSB0aGUgZWxlbWVudHMgZm9yIHRoZSByZW5kZXJpbmdcbiAgICB0aGlzLl9pbml0aWFsQXJyYXkuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGl0ZW0pIHtcbiAgICAvL3Rha2UgdGhlIGl0ZW0gYW5kIHJlbmRlciBpdCBpbnRvIHRoaXMuX2VsZW1lbnRcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3RvcihuYW1lU2VsZWN0b3IsIGRlc2NyaXB0aW9uU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Rlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihkZXNjcmlwdGlvblNlbGVjdG9yKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHRoaXMuX3VzZXJEYXRhID0ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudC50cmltKCksXG4gICAgICBkZXNjcmlwdGlvbjogdGhpcy5fZGVzY3JpcHRpb24udGV4dENvbnRlbnQudHJpbSgpLFxuICAgIH07XG4gICAgcmV0dXJuIHRoaXMuX3VzZXJEYXRhO1xuICB9XG5cbiAgc2V0VXNlckluZm8obmFtZSwgZGVzY3JpcHRpb24pIHtcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9kZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wVXAgZnJvbSBcIi4vUG9wVXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wVXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3BVcCB7XG4gIGNvbnN0cnVjdG9yKHBvcFVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcih7IHBvcFVwU2VsZWN0b3IgfSk7XG5cbiAgICB0aGlzLl9pbWFnZVBvcFVwSW1hZ2VFbCA9IHRoaXMuX3BvcFVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcbiAgICB0aGlzLl9pbWFnZVBvcFVwVGl0bGVFbCA9IHRoaXMuX3BvcFVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX190aXRsZVwiKTtcbiAgfVxuXG4gIG9wZW4oZGF0YSkge1xuICAgIHN1cGVyLm9wZW4oKTtcblxuICAgIHRoaXMuX2ltYWdlUG9wVXBJbWFnZUVsLnNyYyA9IGRhdGEubGluaztcbiAgICB0aGlzLl9pbWFnZVBvcFVwSW1hZ2VFbC5hbHQgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5faW1hZ2VQb3BVcFRpdGxlRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlTGlrZUJ1dHRvbiIsIl9saWtlQnV0dG9uIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiX2hhbmRsZURlbGV0ZUJ1dHRvbiIsIl9jYXJkRWxlbWVudCIsInJlbW92ZSIsIl9zZXRFdmVudExpc3RlbmVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJfZGVsZXRlQnV0dG9uIiwiX2NhcmRJbWFnZUVsIiwiX2NhcmRUaXRsZUVsIiwidGV4dENvbnRlbnQiLCJzcmMiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJjbG9uZU5vZGUiLCJnZW5lcmF0ZUNhcmQiLCJhbHQiLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybSIsIl9pbnB1dEVsZW1lbnRzIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2VFbGVtZW50IiwiaWQiLCJhZGQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFpbGRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsImlucHV0TGlzdCIsImV2ZXJ5IiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZGlzYWJsZUJ1dHRvbiIsIl9lbmFibGVCdXR0b24iLCJkaXNhYmxlZCIsImZvckVhY2giLCJldnQiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJQb3BVcCIsIl9yZWYiLCJwb3BVcFNlbGVjdG9yIiwiX3BvcFVwRWxlbWVudCIsIl9wb3BVcENsb3NlQnV0dG9uIiwiX2hhbmRsZUVzY0Nsb3NlIiwiZSIsImtleSIsImNsb3NlIiwib3BlbiIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wVXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3BVcEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsInNldElucHV0VmFsdWVzIiwiX2lucHV0TGlzdCIsImlucHV0IiwidmFsdWUiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfaW5wdXRWYWx1ZXMiLCJyZXNldCIsInZhbGlkYXRpb25Db25maWciLCJwcm9maWxlUG9wVXBTZWxlY3RvciIsImNhcmRQb3BVcFNlbGVjdG9yIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2hhbmRsZVJlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJtZXRob2QiLCJ0aGVuIiwidXBkYXRlVXNlclByb2ZpbGUiLCJ1c2VyRGF0YSIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwidXBkYXRlQXZhdGFyIiwiX3JlZjIiLCJhdmF0YXIiLCJnZXRJbml0aWFsQ2FyZHMiLCJjcmVhdGVDYXJkIiwiY2FyZERhdGEiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwiYWRkTGlrZSIsInJlbW92ZUxpa2UiLCJhdXRob3JpemF0aW9uIiwiY2FyZExpc3RFbCIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUVkaXRGb3JtIiwiYWRkQ2FyZEJ1dHRvbiIsImFkZENhcmRGb3JtIiwiY2FyZFNlY3Rpb24iLCJjb250YWluZXIiLCJpbml0aWFsQXJyYXkiLCJyZW5kZXJlciIsIl9pbml0aWFsQXJyYXkiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsInByZXBlbmQiLCJjYXJkRWwiLCJ1c2VyIiwibmFtZVNlbGVjdG9yIiwiZGVzY3JpcHRpb25TZWxlY3RvciIsIl9kZXNjcmlwdGlvbiIsIl91c2VyRGF0YSIsInRyaW0iLCJkZXNjcmlwdGlvbiIsInNldFVzZXJJbmZvIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJhZGRGb3JtVmFsaWRhdG9yIiwidmlld0ltYWdlUG9wVXAiLCJfaW1hZ2VQb3BVcEltYWdlRWwiLCJfaW1hZ2VQb3BVcFRpdGxlRWwiLCJwcm9maWxlRWRpdFBvcFVwIiwidGl0bGUiLCJhZGRDYXJkUG9wVXAiLCJjYXJkSW5wdXQiLCJ1cmwiLCJ1c2VyUHJvZmlsZSIsImhhbmRsZVByb2ZpbGVFZGl0QnV0dG9uQ2xpY2siLCJjb25zb2xlIiwibG9nIl0sInNvdXJjZVJvb3QiOiIifQ==